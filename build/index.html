<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <title>CarrotQuest API Reference</title>

    <link href="stylesheets/screen.css" rel="stylesheet" type="text/css" media="screen" />
    <link href="stylesheets/print.css" rel="stylesheet" type="text/css" media="print" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
    <script src="javascripts/all.js" type="text/javascript"></script>

      <script>
        $(function() {
          setupLanguages(["shell"]);
        });
      </script>
  </head>

  <body class="index">
    <div class="tocify-wrapper">
      <img src="images/logo.png" />
        <div class="search">
          <input type="text" class="search" id="input-search">
        </div>
        <div class="search-info"></div>
      <div id="toc">
      </div>
        <ul class="toc-footer">
            <li><a href='http://github.com/tripit/slate'>Documentation Powered by Slate</a></li>
        </ul>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id="Введение">Введение</h1>

<p>Это описание API CarrotQuest</p>

<blockquote>
<p>API enpoint:</p>
</blockquote>
<pre class="highlight plaintext">http://api.carrotquest.io/v1
</pre>

<h1 id="Формат-данных">Формат данных</h1>

<p>Все ответы отдаются в JSON. Других форматов нет и в ближайшее времени не предвидится. Каждый ответ заключен в &ldquo;конверт&rdquo;.</p>

<blockquote>
<p>Конверт</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">

  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<p>Есть два обязательных объекта, присутсвующих в каждом ответе: <code class="prettyprint">data</code> и <code class="prettyprint">meta</code>. Блок <code class="prettyprint">meta</code> содержит метаданные об ответе. Поле <code class="prettyprint">status</code> совпадает с HTTP кодом возврата. Варианты: 200 (OK), 400 (неправильный запрос), 403 (не авторизован), 404 (неверный адрес), 500 (внутренняя ошибка сервера). Если status не равен 200, то добавляются поля <code class="prettyprint">error</code> и <code class="prettyprint">errorMessage</code>.</p>

<blockquote>
<p>Пример ошибочного ответа</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"error"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Error404"</span><span class="p">,</span><span class="w"> 
    </span><span class="s2">"errorMessage"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Path '/api/sdf' not found"</span><span class="p">,</span><span class="w"> 
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">404</span><span class="w">
  </span><span class="p">},</span><span class="w"> 
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">

  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<p>Блок <code class="prettyprint">data</code> содержит сам ответ.</p>

<h1 id="Стиль">Стиль</h1>

<p>API сделан в объектно-ориентированном стиле. Будем очень сильно стараться соотвествовать канонам <a href="http://ru.wikipedia.org/wiki/REST">REST API</a>.</p>

<p>Все, что начинается с символа $ - систмное имя.</p>

<p>Все параметры к запросам - необязательные, если явно не указано обратное.</p>

<h1 id="Ключи">Ключи</h1>

<p>У каждого приложения (app) есть <strong>ID</strong> (идентификатор, положительно число), 
<strong>API Key</strong> (публичный ключ, может появляться в javascript коде), <strong>API Secret</strong>
(приватный ключ, его необходимо хранить в секрете, использовать его можно только с 
серверной стороны, то есть в javascript-коде он ни в коем млучае не должен появляться)</p>

<h1 id="Авторизация">Авторизация</h1>

<p>Для того, чтобы общаться с API, необходима авторизация, чтобы знать, от чьего имени происходит запрос. Каждый запрос должен включать GET-параметр auth_token. Поддерживаются 4 типа тукенов:</p>

<table><thead>
<tr>
<th>auth_token</th>
<th>Где используется</th>
</tr>
</thead><tbody>
<tr>
<td>user.userid.apikey.token</td>
<td>Клиентский JS код на стороне приложения, но без сессии</td>
</tr>
<tr>
<td>session.js.userid.apikey</td>
<td>Клиентский JS код на стороне приложения (<strong>УСТАРЕЛ!</strong>)</td>
</tr>
<tr>
<td>app.apikey.apisecret</td>
<td>Серверный код на стороне приложения</td>
</tr>
<tr>
<td>account.userid.token</td>
<td>Личный кабинет пользователя</td>
</tr>
<tr>
<td>panel.userid.token</td>
<td>Панель администратора</td>
</tr>
<tr>
<td>global.userid.token</td>
<td>Глобальный тукен, который ложиться в куку <code class="prettyprint">carrotquest_auth_token_global</code> на домене .carrotquest.io (хорошо, если браузер юзера сохранит эту куку - тогда можно организовать тотальную слежку). Использовать напрямую его нельзя.</td>
</tr>
<tr>
<td>superuser.XXX</td>
<td><em>TODO</em></td>
</tr>
<tr>
<td>oauth.oauth</td>
<td><em>TODO</em></td>
</tr>
</tbody></table>

<p>Если в auth_token несколько &ldquo;компонентов&rdquo;, они разделены символом точки. apikey, apisecret, userid - нужно заменить на реальные данные.</p>

<p>Например, чтобы обратиться к конечной точке <code class="prettyprint">/users/USER_ID/carrots</code> с серверной стороны, нужно сделать запрос на URL <code class="prettyprint">http://api.carrotquest.io/v1/users/USER_ID/carrots?auth_token=app.XXX.YYY</code> (здесь apikey=XXX, apisecret=YYY)</p>

          <h1 id="errors">Errors</h1>

<p><aside class="notice">This error section is stored in a separate file in <code class="prettyprint">includes/_errors.md</code>. Slate allows you to optionally separate out your docs into many files&hellip;just save them to the <code class="prettyprint">includes</code> folder and add them to the top of your <code class="prettyprint">index.md</code>&rsquo;s frontmatter. Files are included in the order listed.</aside></p>

<p>The Kittn API uses the following error codes:</p>

<table><thead>
<tr>
<th>Error Code</th>
<th>Meaning</th>
</tr>
</thead><tbody>
<tr>
<td>400</td>
<td>Bad Request &ndash; Your request sucks</td>
</tr>
<tr>
<td>401</td>
<td>Unauthorized &ndash; Your API key is wrong</td>
</tr>
<tr>
<td>403</td>
<td>Forbidden &ndash; The kitten requested is hidden for administrators only</td>
</tr>
<tr>
<td>404</td>
<td>Not Found &ndash; The specified kitten could not be found</td>
</tr>
<tr>
<td>405</td>
<td>Method Not Allowed &ndash; You tried to access a kitten with an invalid method</td>
</tr>
<tr>
<td>406</td>
<td>Not Acceptable &ndash; You requested a format that isn&rsquo;t json</td>
</tr>
<tr>
<td>410</td>
<td>Gone &ndash; The kitten requested has been removed from our servers</td>
</tr>
<tr>
<td>418</td>
<td>I&rsquo;m a teapot</td>
</tr>
<tr>
<td>429</td>
<td>Too Many Requests &ndash; You&rsquo;re requesting too many kittens! Slown down!</td>
</tr>
<tr>
<td>500</td>
<td>Internal Server Error &ndash; We had a problem with our server. Try again later.</td>
</tr>
<tr>
<td>503</td>
<td>Service Unavailable &ndash; We&rsquo;re temporarially offline for maintanance. Please try again later.</td>
</tr>
</tbody></table>

          <h1 id="auth">Auth</h1>

<h2 id="Авторизация-из-js-из-приложения">Авторизация из JS из приложения</h2>
<pre class="highlight plaintext">POST http://api.carrotquest.io/v1/auth/jsconnect?auth_token=XXX
</pre>
<pre class="highlight shell">curl <span class="s2">"http://api.carrotquest.io/v1/auth/jsconnect?auth_token=XXX"</span> <span class="se">\</span>
  -d <span class="s2">"app_key=6-a832b29f610bc27d9e9a11249c6192"</span>
</pre>
<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"authToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user.3138.IHBp4Gyaa1an5UbazcZ2J1PHvtZzu6Rg.aa042afad15bf0dbfbb33d5214193369954523dfd5f97e05"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"full"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"hasAvatar"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Maks Materkov"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3138</span><span class="p">,</span><span class="w">
      </span><span class="s2">"carrots"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"app"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"settings"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"bonus"</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<p>Функции может быть передан действительный тукен (типа <code class="prettyprint">user.XXX</code>), но может быть пустым. На сайте клиента тукен сохраняется в куке <code class="prettyprint">carrotquest_auth_token</code>, <strong><em>на домене клиента (!)</em></strong>. Наша JS библиотека при каждой загрузке странице будет смотреть, есть ли уже сохраненный тукен в куках.</p>

<p>В любом случае, функция возвращает authToken, который каждый раз заново устанавливается в куки. Возвращаемый тукен будет тем же самым (чаще всего), но может и быть другим, Например, если сначала юзер зашел на сайт клиента (выдан тукен), затем зарегался в бонусной системе (при этом установился глобальный тукен) и после этого снова вернулся на сайт. Теперь есть старый тукен (в куках на стороне клиента) и установлен глобальный (в куках на нашей стороне). В этом случае будет возвращен новый тукен, т.к. ID пользователя при регистрации изменился.</p>

<h3 id="Параметры">Параметры</h3>

<table><thead>
<tr>
<th>Название</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>app_key</td>
<td>API Key</td>
</tr>
</tbody></table>

<h2 id="Установка-глобального-тукена">Установка глобального тукена</h2>
<pre class="highlight plaintext">GET http://api.carrotquest.io/v1/auth/trackglobal
</pre>
<pre class="highlight shell">curl <span class="s2">"http://api.carrotquest.io/v1/auth/trackglobal?auth_token=XXX"</span>
</pre>
<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<p>Эта функция принимает auth_token и устанавливает куку <code class="prettyprint">carrotquest_auth_token_global</code> (см. описание типов тукенов выше)</p>

<p>Вопрос - зачем нужен глобальные и &ldquo;локальные&rdquo; тукены? Оказалось, что некоторые браузеры (Сафари) не позволяют ставить куки на домены тех сайтов, которые пользователь ни разу не посещал. То есть, например, человек захдит на сайт www.ecodomshop.ru и наша система попытается установить куку, но на домене .carrotquest.io. Этот гадкий браузер не даст этого сделать! Пэтому такая морока с авторизацией и такое разнообразие типов авторизации.</p>

<h2 id="Вход-в-личный-кабинет">Вход в личный кабинет</h2>
<pre class="highlight plaintext">POST http://api.carrotquest.io/v1/auth/accountlogin
</pre>
<pre class="highlight shell">curl <span class="s2">"http://api.carrotquest.io/v1/auth/accountlogin"</span> <span class="se">\</span>
  -d <span class="s2">"email=my@email.com"</span> <span class="se">\</span>
  -d <span class="s2">"password=1234"</span>
</pre>
<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"authToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"account.123.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<p>Вход в личный кабинет. Если вход успешен, в ответе будет содержаться authToken, который нужно использовать для общения с API в личном кабинете юзера (тукен типа <code class="prettyprint">account.XXX</code>).</p>

<p>Если неправильные емейл/пароль, будет ответ 400 с ошибкой <code class="prettyprint">InvalidCredentials</code>.</p>

<h3 id="Параметры">Параметры</h3>

<table><thead>
<tr>
<th>Название</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>Email</td>
</tr>
<tr>
<td>password</td>
<td>Password</td>
</tr>
</tbody></table>

<h2 id="Регистрация-в-бонусной-системе">Регистрация в бонусной системе</h2>
<pre class="highlight plaintext">POST http://api.carrotquest.io/v1/auth/accountregister
</pre>

<p>Попытка регистрации пользователя в бонусной системе. Параметр - email. Если такого емейла нет, то он регистрируется (пароль высылается на почту). Если регистрация успешна, в ответе будет содержаться authToken для работы в личном кабинете (тукен типа <code class="prettyprint">account.XXX</code>)</p>

<h2 id="Вход-в-панель-администратора">Вход в панель администратора</h2>
<pre class="highlight plaintext">POST http://api.carrotquest.io/v1/auth/panellogin
</pre>
<pre class="highlight shell">curl <span class="s2">"http://api.carrotquest.io/v1/auth/panellogin?auth_token=XXX"</span> <span class="se">\</span>
  -d <span class="s2">"email=my@email.com"</span> <span class="se">\</span>
  -d <span class="s2">"password=1234"</span>
</pre>
<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"authToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"panel.123.xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<p>Вход в панель администратора. Если вход успешен, в ответе будет содержаться authToken, который нужно использовать для общения с API в панели администратора (тукен типа <code class="prettyprint">panel.XXX</code>)</p>

<p>Если неправильные емейл/пароль, будет ответ 400 с ошибкой <code class="prettyprint">InvalidCredentials</code>.</p>

<h3 id="Параметры">Параметры</h3>

<table><thead>
<tr>
<th>Название</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>email</td>
<td>Email</td>
</tr>
<tr>
<td>password</td>
<td>Password</td>
</tr>
</tbody></table>

<h3 id="Возвращаемое-значение">Возвращаемое значение</h3>

<p>Возвращает authToken</p>

<h2 id="Проверка-тукена">Проверка тукена</h2>
<pre class="highlight plaintext">GET http://api.carrotquest.io/v1/auth/checktoken
</pre>
<pre class="highlight shell">curl <span class="s2">"http://api.carrotquest.io/v1/auth/checktoken?auth_token=XXX"</span>
</pre>
<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"panel"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"created"</span><span class="p">:</span><span class="w"> </span><span class="mi">1402976580</span><span class="p">,</span><span class="w">
    </span><span class="s2">"user"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
    </span><span class="s2">"app"</span><span class="p">:</span><span class="w"> </span><span class="err">null</span><span class="p">,</span><span class="w">
    </span><span class="s2">"authToken"</span><span class="p">:</span><span class="w"> </span><span class="s2">"panel.2.723b2f823d427a10adc79a02117d2d8eff6cb164ec2e8619"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<p>Выдает описание тукена</p>

<h3 id="Вовзращаемое-значение">Вовзращаемое значение</h3>

<p>Возвращает информацию о переданном тукене</p>

          <h1 id="apps">Apps</h1>

<h2 id="Объект-app">Объект App</h2>

<blockquote>
<p>Пример объекта</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"app"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test shop2"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"origin"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8080"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"api_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e6rF5TPZhrWXETArwwXWFJ20b6rOxQHf"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"admins"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="mi">2</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<table><thead>
<tr>
<th>Название</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>ID</td>
</tr>
<tr>
<td>name</td>
<td>Имя приложения. Должно быть уникальным.</td>
</tr>
<tr>
<td>origin</td>
<td>Адрес приложения</td>
</tr>
<tr>
<td>apiKey</td>
<td>API Key</td>
</tr>
<tr>
<td>admins</td>
<td>Массив, ID пользователей, которым разрешен доступ к панели администратора этого рпиложения</td>
</tr>
</tbody></table>

<h2 id="Объект-app-(расширенный)">Объект App (расширенный)</h2>

<blockquote>
<p>Пример объекта</p>
</blockquote>
<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"app"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test shop2"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"origin"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://example.com"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"apiKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e6rF5TPZhrWX2TArwvXWFJ20b6r3xQHf"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"apiSecret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"lvM9T5pm14WGOzvYyHc5ZCMtwss7apZ4H9i2LNeoyw3KbI6J5BcHlhDfCpeIpBN8"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"admins"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="mi">2</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"settings"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"maxDiscount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.05"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"convertedPercent"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.3"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"bonus"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"bonus_account"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="s2">"bonusLanding"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://example.com/"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<table><thead>
<tr>
<th>Название</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>id</td>
<td>ID</td>
</tr>
<tr>
<td>name</td>
<td>Имя приложения. Должно быть уникальным.</td>
</tr>
<tr>
<td>origin</td>
<td>Адрес приложения</td>
</tr>
<tr>
<td>apiKey</td>
<td>API Key</td>
</tr>
<tr>
<td>apiSecret</td>
<td>API Secret</td>
</tr>
<tr>
<td>admins</td>
<td>Массив, ID пользователей, которым разрешен доступ к панели администратора этого рпиложения</td>
</tr>
<tr>
<td>settings.maxDiscount</td>
<td>Максимальный процент скидки</td>
</tr>
<tr>
<td>settings.convertedPercent</td>
<td>Процент от цены, который конвертируется в морковки</td>
</tr>
<tr>
<td>settings.bonus</td>
<td>Включена ли бонусная система</td>
</tr>
<tr>
<td>settings.bonusLanding</td>
<td>Стрнаица, на которую ведут реккомендации</td>
</tr>
</tbody></table>

<h2 id="Информация-о-приложении">Информация о приложении</h2>
<pre class="highlight plaintext">GET http://api.carrotquest.io/v1/apps/{APP_ID}
</pre>
<pre class="highlight shell">curl <span class="s2">"http://api.carrotquest.io/v1/apps/5?auth_token=XXX"</span>
</pre>
<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"app"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"EcoDom"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"origin"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://www.ecodomshop.ru"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"api_key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"9aZIEqDHAjhMi0wHoD8udndOyJSFGZkg"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"admins"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="mi">273</span><span class="p">,</span><span class="w">
        </span><span class="mi">147</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<p>Выдает базовую, общедоступную информацию о приложении.</p>

<h3 id="Возаращаемое-значение">Возаращаемое значение</h3>

<p>Возвращает <a href="#Объект-app">базовый объект App</a></p>

<h2 id="Расширенная-информация-о-приложении">Расширенная информация о приложении</h2>
<pre class="highlight plaintext">GET http://api.carrotquest.io/v1/apps/{APP_ID}/extendedinfo
</pre>
<pre class="highlight shell">curl <span class="s2">"http://api.carrotquest.io/v1/apps/5/extendedinfo?auth_token=XXX"</span>
</pre>
<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"app"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test shop2"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"origin"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8080"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"apiKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e6rF5TPchrWXE5ArwwXWFJ20b6rOxQHf"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"apiSecret"</span><span class="p">:</span><span class="w"> </span><span class="s2">"lvM9T5pm14WGvzvYyHm5ZCjtwss7apZ4W9i1LNeoywwKbI6J5BcHdhDfCpeIpBN8"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"admins"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="mi">1</span><span class="p">,</span><span class="w">
        </span><span class="mi">2</span><span class="w">
      </span><span class="p">],</span><span class="w">
      </span><span class="s2">"settings"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="s2">"maxDiscount"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.05"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"convertedPercent"</span><span class="p">:</span><span class="w"> </span><span class="s2">"0.3"</span><span class="p">,</span><span class="w">
        </span><span class="s2">"bonus"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
        </span><span class="s2">"bonus_account"</span><span class="p">:</span><span class="w"> </span><span class="s2">""</span><span class="p">,</span><span class="w">
        </span><span class="s2">"bonusLanding"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8080/"</span><span class="w">
      </span><span class="p">}</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<p>Выдает базовую, общедоступную информацию о приложении.</p>

<h3 id="Возаращаемое-значение">Возаращаемое значение</h3>

<p>Возвращает <a href="#Объект-app-(расширенный)">расширенный объект App</a></p>

<h2 id="Создать-приложение">Создать приложение</h2>
<pre class="highlight plaintext">POST http://api.carrotquest.io/v1/apps
</pre>
<pre class="highlight shell">curl <span class="s2">"http://api.carrotquest.io/v1/apps?auth_token=XXX"</span> <span class="se">\</span>
  -d <span class="s2">"name=My super app"</span>
  -d <span class="s2">"origin=http://mydomain.ru"</span>
</pre>
<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"app"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Test shop2"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"origin"</span><span class="p">:</span><span class="w"> </span><span class="s2">"http://localhost:8080"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"apiKey"</span><span class="p">:</span><span class="w"> </span><span class="s2">"e6rF5TPchrWXE5ArwwXWFJ20b6rOxQHf"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"admins"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="mi">3</span><span class="w">
      </span><span class="p">]</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<p>Создает новое приложение</p>

<h3 id="Параметры">Параметры</h3>

<table><thead>
<tr>
<th>Название</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td><strong>обязательный</strong> Название приложения</td>
</tr>
<tr>
<td>origin</td>
<td>Адрес приложения</td>
</tr>
</tbody></table>

<h3 id="Возаращаемое-значение">Возаращаемое значение</h3>

<p>Если приложение создано успешно, возвращает <a href="#Объект-app">базовый объект App</a>.</p>

<p>Если имя не уникально, возвращатся ошибка <code class="prettyprint">AppNameDuplicate</code> (статус 400)</p>

<h2 id="Проверить-занятость-имени">Проверить занятость имени</h2>
<pre class="highlight plaintext">GET http://api.carrotquest.io/v1/apps/checknameavailable
</pre>
<pre class="highlight shell">curl <span class="s2">"http://api.carrotquest.io/v1/apps/checknameavailable?auth_token=XXX&amp;name=MySuperApp"</span>
</pre>
<pre class="highlight json"><span class="p">{</span><span class="w">
  </span><span class="s2">"data"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"available"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="s2">"meta"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"status"</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre>

<p>Проверяет, доступно ли имя для приложение (имена должны быть уникальными)</p>

<h3 id="Параметры">Параметры</h3>

<table><thead>
<tr>
<th>Название</th>
<th>Описание</th>
</tr>
</thead><tbody>
<tr>
<td>name</td>
<td><strong>обязательный</strong> Название приложения</td>
</tr>
</tbody></table>

<h3 id="Возаращаемое-значение">Возаращаемое значение</h3>

<p>Если имя доступно, то перемнная <code class="prettyprint">available</code> будет иметь значение <code class="prettyprint">true</code>; иначе - <code class="prettyprint">false</code></p>

          <h1 id="&nbsp;">&nbsp;</h1>

      </div>
      <div class="dark-box">
          <div id="lang-selector">
                <a href="#" data-language-name="shell">shell</a>
          </div>
      </div>
    </div>
  </body>
</html>
